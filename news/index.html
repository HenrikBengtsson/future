<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • future</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Changelog" />
<meta property="og:image" content="/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">future</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.0-9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/future-1-overview.html">A Future for R: A Comprehensive Overview</a>
    </li>
    <li>
      <a href="../articles/future-2-output.html">A Future for R: Text and Message Output</a>
    </li>
    <li>
      <a href="../articles/future-3-topologies.html">A Future for R: Future Topologies</a>
    </li>
    <li>
      <a href="../articles/future-4-issues.html">A Future for R: Common Issues with Solutions</a>
    </li>
    <li>
      <a href="../articles/future-4-non-exportable-objects.html">A Future for R: Non-Exportable Objects</a>
    </li>
    <li>
      <a href="../articles/future-5-startup.html">A Future for R: Controlling Default Future Strategy</a>
    </li>
    <li>
      <a href="../articles/future-6-future-api-backend-specification.html">A Future for R: Future API Backend Specification</a>
    </li>
    <li>
      <a href="../articles/future-7-for-package-developers.html">A Future for R: Best Practices for Package Developers</a>
    </li>
    <li>
      <a href="../articles/future-8-how-future-is-validated.html">A Future for R: How the Future Framework is Validated</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HenrikBengtsson/future/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/HenrikBengtsson/future/blob/master/NEWS'><code>NEWS</code></a></small>
    </div>

    <div id="future-1-21-0-9000" class="section level1">
<h1 class="page-header" data-toc-text="1.21.0-9000">
<a href="#future-1-21-0-9000" class="anchor"></a>future 1.21.0-9000<small> Unreleased </small>
</h1>
<div id="significant-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes" class="anchor"></a>Significant Changes</h3>
<ul>
<li><p>A lazy future remains a generic future until it is launched, which means it is not assigned a future backend class until launched.</p></li>
<li><p>Argument ‘seed’ for futureAssign() and futureCall() now defaults to FALSE just like for future().</p></li>
<li><p>R_FUTURE_* environment variables are now only read when the ‘future’ package is loaded, where they set the corresponding future.* option. Previously, some of these environment variables were queried by different functions as a fallback to when an option was not set. By only parsing them when the package is loaded, it decrease the overhead in functions, and it clarifies that options can be changed at runtime whereas environment variables should only be set at startup.</p></li>
</ul>
</div>
<div id="performance" class="section level3">
<h3 class="hasAnchor">
<a href="#performance" class="anchor"></a>Performance</h3>
<ul>
<li>The overhead of initiating futures have been significantly reduced. For example, the roundtrip time for value(future(NULL)) is about twice as fast for ‘sequential’, ‘cluster’, and ‘multisession’ futures. For ‘multicore’ futures the roundtrip speedup is about 20%. The speedup comes from pre-compiling the R expression that will be used to resolve the future expression into R expression templates which then can quickly compiled for each future. This speeds up the creation of these expression by ~10 times, compared when re-compiling them each time.</li>
</ul>
</div>
<div id="new-features" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features" class="anchor"></a>New Features</h3>
<ul>
<li><p>In addition to specify which condition classes to be captured and relayed, it is now possible to also specify condition classes to be ignored. For example, conditions = structure(“condition”, exclude = “message”) captures all conditions but message conditions.</p></li>
<li><p>Now cluster futures use ‘homogeneous = NULL’ as the default instead of ‘homogeneous = TRUE’. The new default will result in the ‘parallelly’ package trying to infer whether TRUE or FALSE should be used based on the ‘workers’ argument.</p></li>
</ul>
</div>
<div id="bug-fixes" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Resolving a ‘sequential’ future without globals would result in internal several ‘…future.*’ objects being written to the calling environment, which might be the global environment.</p></li>
<li><p>Environment variable ‘R_FUTURE_PLAN’ would propagate down with nested futures, forcing itself onto also nested future plans. Now it is unset in nested futures, resulting in a sequential future strategy unless another was explicitly set by `plan()`.</p></li>
<li><p>Transparent futures no longer warns about ‘local = FALSE’ being deprecated. Although ‘local=FALSE’ is being deprecated, it is still used internally by ‘transparent’ futures for a while longer. Please do not use ‘transparent’ futures in production code and never in a package.</p></li>
<li><p>remote() could produce an error on “object ‘homogeneous’ not found”.</p></li>
<li><p>nbrOfFreeWorkers() for ‘cluster’ futures assumed that the current plan is set to cluster too.</p></li>
</ul>
</div>
</div>
    <div id="future-1-21-0" class="section level1">
<h1 class="page-header" data-toc-text="1.21.0">
<a href="#future-1-21-0" class="anchor"></a>future 1.21.0<small> 2020-12-10 </small>
</h1>
<div id="new-features-1" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-1" class="anchor"></a>New Features</h3>
<ul>
<li><p>In order to handle them conditionally higher up in the call chain, warnings and errors produced from using the random number generator (RNG) in a future without declaring the intention to use one are now of class RngFutureWarning and RngFutureError, respectively. Both of these classes inherits from RngFutureCondition.</p></li>
<li><p>Now run-time errors from resolving a future take precedence over RngFutureError:s. That is, future({ rnorm(1); log(“a”) }, seed = FALSE) will signal an error ‘log(“a”)’ instead of an RNG error when option ‘future.rng.onMisuse’ is set to “error”.</p></li>
</ul>
</div>
<div id="beta-features" class="section level3">
<h3 class="hasAnchor">
<a href="#beta-features" class="anchor"></a>Beta Features</h3>
<ul>
<li>Add nbrOfFreeWorkers() to query how many workers are free to take on futures immediately. Until all third-party future backends have implemented this, some backends might produce an error saying it is not yet supported.</li>
</ul>
</div>
<div id="bug-fixes-1" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-1" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>future(…, seed = TRUE) with ‘sequential’ futures would set the RNG kind of the parent process. Now it behaves the same regardless of future backend.</p></li>
<li><p>Signaling immediateCondition:s with ‘multicore’ could result in “Error in save_rds(obj, file) : save_rds() failed to rename temporary save file ‘/tmp/RtmpxNyIyK/progression21f3f31eadc.rds.tmp’ (NA bytes; last modified on NA) to ‘/tmp/RtmpxNyIyK/progression21f3f31eadc.rds’ (NA bytes; last modified on NA)”. There was an assertion at the end of the internal save_rds() function that incorrectly assumed that the target file should exist. However, the file might have already been processed and removed by the future in the main R session.</p></li>
<li><p>value() with both a run-time error and an RNG mistake would signal the RNG warning instead of the run-time error when the for-internal-use-only argument ‘signal’ was set to FALSE.</p></li>
<li><p>Due to a mistake introduced in future 1.20.0, the package would end up assigning a ‘.packageVersion’ object to the global environment when loaded.</p></li>
</ul>
</div>
</div>
    <div id="future-1-20-1" class="section level1">
<h1 class="page-header" data-toc-text="1.20.1">
<a href="#future-1-20-1" class="anchor"></a>future 1.20.1<small> 2020-11-03 </small>
</h1>
<div id="bug-fixes-2" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-2" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>future::plan(“multisession”) would produce ‘Error in if (debug) mdebug(“covr::package_coverage() workaround …”) : argument is not interpretable as logical’ if and only if the ‘covr’ package was loaded.</li>
</ul>
</div>
</div>
    <div id="future-1-20-0" class="section level1">
<h1 class="page-header" data-toc-text="1.20.0">
<a href="#future-1-20-0" class="anchor"></a>future 1.20.0<small> Unreleased </small>
</h1>
<div id="significant-changes-1" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-1" class="anchor"></a>Significant Changes</h3>
<ul>
<li><p>Strategy ‘multiprocess’ is deprecated in favor of either ‘multisession’ or ‘multicore’, depending on operating system and R setup. The plan() function will give an informative deprecation warning when ‘multiprocess’ is used. This warning is given only once per R session.</p></li>
<li><p>Launching R or Rscript with command-line option –parallel=n, where n &gt; 1, will now use ‘multisession’ as future strategy. Previously, it would use ‘multiprocess’, which is now deprecated.</p></li>
<li><p>Support for ‘local = FALSE’ is deprecated. For the time being, it remains supported for ‘transparent’ futures and ‘cluster’ futures that use ‘persistent = TRUE’. However, note that ‘persistent = TRUE’ will also deprecated at some point in the future. These deprecations are required in order to further standardize the Future API across various types of parallel backends.</p></li>
<li><p>Now multisession workers inherit the package library path from the main R session *when they are created*, that is, when calling plan(multisession). To avoid this, use plan(multisession, rscript_libs = NULL), which is an argument passed down to makeClusterPSOCK(). With this update, ‘sequential’, ‘multisession’, and ‘multicore’ futures see the exact same library path.</p></li>
<li><p>Several functions for managing ‘parallel’-style processing have been moved to a new ‘parallelly’ package. Specifically, functions availableCores(), availableWorkers(), supportsMulticore(), as.cluster(), autoStopCluster(), makeClusterMPI(), makeClusterPSOCK(), and makeNodePSOCK() have been moved. None of them are specific to futures per se and are likely useful elsewhere too. Also, having them in a separate, standalone package will speed up the process of releasing any updates to these functions. The code base of the ‘future’ package shrunk about 10-15% from this migration. For backward compatibility, the migrated functions remain in this package as re-exports.</p></li>
</ul>
</div>
<div id="new-features-2" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-2" class="anchor"></a>New Features</h3>
<ul>
<li><p>Setting up a future strategy with argument ‘split = TRUE’ will cause the standard output and non-error conditions to be split (“tee:d”) on the worker’s end, while still relaying back to the main R session as before. This can be useful when debugging with browse() or debug(), e.g. plan(sequential, split = TRUE). Without it, debug output is not displayed.</p></li>
<li><p>Now multicore futures relay immediateCondition:s in a near-live fashion.</p></li>
<li><p>It is now possible to pass any arguments that makeClusterPSOCK() accepts in the call to plan(cluster, …) and plan(multisession, …). For instance, to set the working directory of the cluster workers to a temporary folder, pass argument ‘rscript_startup = “setwd(tempdir())”’. Another example is ‘rscript_libs = c(libs, “*”)’ to prepend the library path on the worker with the paths in ‘libs’.</p></li>
<li><p>plan() and tweak() check for even more arguments that must not be set by either of them. Specifically, attempts to adjust the following arguments of future() will result in an error: ‘conditions’, ‘envir’, ‘globals’, ‘packages’, ‘stdout’, and ‘substitute’ in addition to already validated ‘lazy’ and ‘seed’.</p></li>
<li><p>tweak() now returns a wrapper function that calls the original future strategy function with the modified defaults. Previously, it would make a copy of the original function with modified argument defaults. This new approach will make it possible to introduce new future arguments that can be modified by tweak() and plan() without having to update every future backend package, e.g. the new ‘split = TRUE’ argument.</p></li>
</ul>
</div>
<div id="documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h3>
<ul>
<li><p>Add a ‘Best Practices for Package Developers’ vignette.</p></li>
<li><p>Add a ‘How the Future Framework is Validated’ vignette.</p></li>
</ul>
</div>
<div id="miscellaneous" class="section level3">
<h3 class="hasAnchor">
<a href="#miscellaneous" class="anchor"></a>Miscellaneous</h3>
<ul>
<li>Harmonizing Future constructor functions to also use ‘substitute = TRUE’.</li>
</ul>
</div>
<div id="bug-fixes-3" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-3" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Since last version, future 1.19.1, future(…, conditions = character(0L)) would no longer avoid intercepting conditions as intended; instead, it muffles all conditions. From now on, use ‘conditions = NULL’.</p></li>
<li><p>Relaying of immediateCondition:s was not near-live for multisession and cluster if the underlying PSOCK cluster used useXDR=FALSE for communication.</p></li>
<li><p>print() for Future would also print any attributes of its environment.</p></li>
<li><p>The error message produced by nbrOfWorkers() was incomplete.</p></li>
<li><p>Renamed environment variable ‘R_FUTURE_MAKENODEPSOCK_tries’ used by makeClusterPSOCK() to ‘R_FUTURE_MAKENODEPSOCK_TRIES’.</p></li>
<li><p>The Mandelbrot demo would produce random numbers without declaring so.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Strategy ‘multiprocess’ is deprecated in favor of either ‘multisession’ or ‘multicore’, depending on operating system and R setup.</p></li>
<li><p>values() is deprecated. Use value() instead.</p></li>
<li><p>All backward compatible code for the legacy, defunct, internal Future element ‘value’ is now removed. Using or relying on it is an error.</p></li>
</ul>
</div>
</div>
    <div id="future-1-19-1" class="section level1">
<h1 class="page-header" data-toc-text="1.19.1">
<a href="#future-1-19-1" class="anchor"></a>future 1.19.1<small> 2020-09-22 </small>
</h1>
<div id="bug-fixes-4" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-4" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>When passing ‘…’ as a globals, rather than via arguments, in higher-level map-reduce APIs such as future.apply and furrr, arguments in ‘…’ could produce an error on “unused argument”.</li>
</ul>
</div>
</div>
    <div id="future-1-19-0" class="section level1">
<h1 class="page-header" data-toc-text="1.19.0">
<a href="#future-1-19-0" class="anchor"></a>future 1.19.0<small> Unreleased </small>
</h1>
<div id="significant-changes-2" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-2" class="anchor"></a>Significant Changes</h3>
<ul>
<li><p>Futures detect when random number generation (RNG) was used to resolve them. If a future uses RNG without parallel RNG was requested, then an informative warning is produced. To request parallel RNG, specify argument ‘seed’, e.g. ‘f &lt;- future(rnorm(3), seed=TRUE)’ or ‘y %&lt;-% { rnorm(3) } %seed% TRUE’. Higher-level map-reduce APIs provide similarly named “seed” arguments to achieve the same. To, escalate these warning to errors, set option ‘future.rng.onMisuse’ to “error”. To silence them, set it to “ignore”.</p></li>
<li><p>Now, all non-captured conditions are muffled, if possible. For instance, future(warning(“boom”), conditions = c(“message”)) will truly muffle the warning regardless of backend used. This was needed to fix below bug.</p></li>
</ul>
</div>
<div id="new-features-3" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-3" class="anchor"></a>New Features</h3>
<ul>
<li><p>makeClusterPSOCK() will now retry to create a cluster node up to ‘tries’ (default: 3) times before giving up. If argument ‘port’ species more than one port (e.g. port = “random”) then it will also attempt find a valid random port up to ‘tries’ times before giving up. The pre-validation of the random port is only supported in R (&gt;= 4.0.0) and skipped otherwise.</p></li>
<li><p>makeClusterPSOCK() skips shell quoting of the elements in ‘rscript’ if it inherits from ‘AsIs’.</p></li>
<li><p>makeClusterPSOCK(), or actually makeNodePSOCK(), gained argument ‘quiet’, which can be used to silence output produced by ‘manual = TRUE’.</p></li>
<li><p>If multithreading is disabled but multicore futures fail to acknowledge the setting on the current system, then an informative FutureWarning is produced by such futures.</p></li>
<li><p>Now availableCores() better supports Slurm. Specifically, if environment variable ‘SLURM_CPUS_PER_TASK’ is not set, which requires that option –slurm-cpus-per-task=n’ is specified and SLURM_JOB_NUM_NODES=1, then it falls back to using ‘SLURM_CPUS_ON_NODE’, e.g. when using ‘–ntasks=n’.</p></li>
<li><p>Now availableCores() and availableWorkers() supports LSF/OpenLava. Specifically, they acknowledge environment variable ‘LSB_DJOB_NUMPROC’ and ‘LSB_HOSTS’, respectively.</p></li>
</ul>
</div>
<div id="performance-1" class="section level3">
<h3 class="hasAnchor">
<a href="#performance-1" class="anchor"></a>Performance</h3>
<ul>
<li>Now plan(multisession), plan(cluster, workers = <number>), and makeClusterPSOCK() which they both use internally, sets up localhost workers twice as fast compared to versions since future 1.12.0, which brings it back to par with a bare-bone parallel::makeCluster(…, setup_strategy = “sequential”) setup. The slowdown was introduced in future 1.12.0 (2019-03-07) when protection against leaving stray R processes behind from failed worker startup was implemented. This protection now makes use of memoization for speedup.</number>
</li>
</ul>
</div>
<div id="bug-fixes-5" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-5" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Sequential and multicore backends, but not multisession, would produce errors on “‘…’ used in an incorrect context” in cases where ‘…’ was part of argument ‘globals’ and not the evaluation environment.</p></li>
<li><p>Contrary to other future backends, any conditions produced while resolving a sequential future using future(…, conditions = character()) would be signaled, although the most reasonable expectation would be that they are silenced. Now, all non-captured conditions are muffled, if possible.</p></li>
<li><p>Option ‘future.rng.onMisuse’ was not passed down to nested futures.</p></li>
<li><p>Disabling multithreading in forked processes by setting R option ‘future.fork.multithreading.enable’ or environment variable ‘R_FUTURE_FORK_MULTITHREADING_ENABLE’ to ‘FALSE’ would cause multicore futures to always return value 1L. This bug was introduced in future 1.17.0 (2020-04-17).</p></li>
<li><p>getGlobalsAndPackages() did not always return a ‘globals’ element that was of class FutureGlobals.</p></li>
<li><p>getGlobalsAndPackages(…, globals) would recalculate ‘total_size’ even when it was already calculated or known to be zero.</p></li>
<li><p>getGlobalsAndPackages(Formula::Formula(~ x)) would produce “the condition has length &gt; 1” warnings (which will become errors in future R versions).</p></li>
</ul>
</div>
</div>
    <div id="future-1-18-0" class="section level1">
<h1 class="page-header" data-toc-text="1.18.0">
<a href="#future-1-18-0" class="anchor"></a>future 1.18.0<small> 2020-07-09 </small>
</h1>
<div id="significant-changes-3" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-3" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Support for ‘persistent = TRUE’ with multisession futures is deprecated.</li>
</ul>
</div>
<div id="new-features-4" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-4" class="anchor"></a>New Features</h3>
<ul>
<li><p>print() on RichSOCKcluster gives information not only on the name of the host but also on the version of R and the platform of each node (“worker”), e.g. “Socket cluster with 3 nodes where 2 nodes are on host ‘localhost’ (R version 4.0.0 (2020-04-24), platform x86_64-w64-mingw32), 1 node is on host ‘n3’ (R version 3.6.3 (2020-02-29), platform x86_64-pc-linux-gnu)”.</p></li>
<li><p>Error messages from cluster future failures are now more informative than “Unexpected result (of class ‘NULL’ != ‘FutureResult’)”. For example, if the ‘future’ package is not installed on the worker, then the error message clearly says so. Even, if there is an unexpected result error from a PSOCK cluster future, then the error produced give extra information on node where it failed, e.g. “Unexpected result (of class ‘NULL’ != ‘FutureResult’) retrieved for ClusterFuture future (label = ‘<none>’, expression = ‘…’): This suggests that the communication with ClusterFuture worker (‘RichSOCKnode’ <a href='https://github.com/HenrikBengtsson/future/issues/1'>#1</a> on host ‘n3’ (R version 3.6.3 (2020-02-29), platform x86_64-pc-linux-gnu)) is out of sync.”</none></p></li>
<li><p>It is now possible to set environment variables on workers before they are launched by makeClusterPSOCK() by specify them as as “<name>=<value>” as part of the ‘rscript’ vector argument, e.g. rscript=c(“ABC=123”, “DEF=‘hello world’”, “Rscript”). This works because elements in ‘rscript’ that match regular expression ‘^[[:alpha:]_][[:alnum:]_]*=.*’ are no longer shell quoted.</value></name></p></li>
<li><p>makeClusterPSOCK() now returns a cluster that in addition to inheriting from’ SOCKcluster’ it will also inherit from ‘RichSOCKcluster’.</p></li>
</ul>
</div>
<div id="bug-fixes-6" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-6" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Made makeClusterPSOCK() and makeNodePSOCK() agile to the name change from parallel:::.slaveRSOCK() to parallel:::.workRSOCK() in R (&gt;= 4.1.0).</p></li>
<li><p>makeClusterPSOCK(…, rscript) will not try to locate rscript[1] if argument ‘homogeneous’ is FALSE (or inferred to be FALSE).</p></li>
<li><p>makeClusterPSOCK(…, rscript_envs) would result in a syntax error when starting the workers due to non-ASCII quotation marks if option ‘useFancyQuotes’ was not set to FALSE.</p></li>
<li><p>plan(list(…)) would produce ‘Error in UseMethod(“tweak”) : no applicable method for ’tweak’ applied to an object of class “list”‘if a non-function object named ’list’ was on the search path.</p></li>
<li><p>plan(x$abc) with x &lt;- list(abc = sequential) would produce ‘Error in UseMethod(“tweak”) : no applicable method for ’tweak’ applied to an object of class “c(‘FutureStrategyList’, ‘list’)”’.</p></li>
<li><p>TESTS: ‘R_FUTURE_FORK_ENABLE=false R CMD check …’ would produce ‘Error: connections left open: …’ when checking the ‘multiprocess’ example.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-1" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-1" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Support for ‘persistent = TRUE’ with multisession futures is deprecated. If still needed, a temporary workaround is to use cluster futures. However, it is likely that support for ‘persistent’ will eventually be deprecated for all future backends.</p></li>
<li><p>Options ‘future.globals.method’, ‘future.globals.onMissing’, and ‘future.globals.resolve’ are deprecated and produce warnings if set. They may only be used for troubleshooting purposes because they may affect how futures are evaluated, which means that reproducibility cannot be guaranteed elsewhere.</p></li>
</ul>
</div>
</div>
    <div id="future-1-17-0" class="section level1">
<h1 class="page-header" data-toc-text="1.17.0">
<a href="#future-1-17-0" class="anchor"></a>future 1.17.0<small> 2020-04-18 </small>
</h1>
<div id="significant-changes-4" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-4" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Renamed values() to value() to clean up and simplify the API.</li>
</ul>
</div>
<div id="new-features-5" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-5" class="anchor"></a>New Features</h3>
<ul>
<li><p>makeClusterPSOCK() gained argument ‘rscript_envs’ for setting environment variables in workers on startup, e.g. rscript_envs = c(FOO = “3.14”, “BAR”).</p></li>
<li><p>Now the result of a future holds session details in case an error occurred while evaluating the future.</p></li>
</ul>
</div>
<div id="miscellaneous-1" class="section level3">
<h3 class="hasAnchor">
<a href="#miscellaneous-1" class="anchor"></a>Miscellaneous</h3>
<ul>
<li>Not all CRAN servers have _R_CHECK_LIMIT_CORES_ set. To better emulate CRAN submission checks, the future package will, when loaded, set this environment variable to ‘TRUE’ if unset and if ‘R CMD check’ is running. Note that future::availableCores() respects _R_CHECK_LIMIT_CORES_ and returns at most 2L (two cores) if detected.</li>
</ul>
</div>
<div id="bug-fixes-7" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-7" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Any globals named ‘version’ and ‘has_future’ would be overwritten with “garbage” values internally.</p></li>
<li><p>Disabling of multi-threading when using ‘multicore’ futures did not work on all platforms.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-2" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-2" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>All values() S3 methods have been renamed to value() since they are closely related to the original purpose value(). The values() methods will continue to work but will soon be formally deprecated and later be made defunct and finally be removed. Please replace all values() with value() calls.</li>
</ul>
</div>
</div>
    <div id="future-1-16-0" class="section level1">
<h1 class="page-header" data-toc-text="1.16.0">
<a href="#future-1-16-0" class="anchor"></a>future 1.16.0<small> 2020-01-16 </small>
</h1>
<div id="significant-changes-5" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-5" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Now oplan &lt;- plan(new_strategy) returns the list of all nested strategies previously set, instead of just the strategy on top of this stack. This makes it easier to temporarily use another plan. For the old behavior, use ‘oplan &lt;- plan(new_strategy)[[1]]’.</li>
</ul>
</div>
<div id="new-features-6" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-6" class="anchor"></a>New Features</h3>
<ul>
<li><p>Now value() detects if a future(…, seed = FALSE) call generated random numbers, which then might give unreliable results because non-parallel safe, non-statistically sound random number generation (RNG) was used. If option ‘future.rng.onMisuse’ is “warning”, a warning is produced. If “error”, an error is produced. If “ignore” (default), the mistake is silently ignored. Using seed = NULL is like seed = FALSE but without performing the RNG validation.</p></li>
<li><p>For convenience, argument ‘seed’ of future() may now also be an ordinary single integer random seed. If so, a L’Ecuyer-CMRG RNG seed is created from this seed. If seed = TRUE, then a L’Ecuyer-CMRG RNG seed based on the current RNG state is used. Use seed = FALSE when it is known that the future does not use RNG.</p></li>
<li><p>ClusterFuture:s now relay immediateCondition:s back to the main process momentarily after they are signaled and before the future is resolved.</p></li>
</ul>
</div>
<div id="beta-features-1" class="section level3">
<h3 class="hasAnchor">
<a href="#beta-features-1" class="anchor"></a>Beta Features</h3>
<ul>
<li>Add support for automatically disable multi-threading when using ‘multicore’ futures. For now, the default is to allow multi-threaded processing but this might change in the future. To disable multi-threaded, set option ‘future.fork.multithreading.enable’ or environment variable ‘R_FUTURE_FORK_MULTITHREADING_ENABLE’ to ‘FALSE’. This requires that ‘RhpcBLASctl’ package is installed. Parallelization via multi-threaded processing (done in native code by some packages and externally library) while at the same time using forked (aka “multicore”) parallel processing is unstable in some cases. Note that this is not only true when using plan(multicore) but also when using, for instance, parallel::mclapply(). This is in beta so the above names and options might change later.</li>
</ul>
</div>
<div id="bug-fixes-8" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-8" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Evaluation of futures could fail if the global environment contained *functions* with the same names as a small set of base R functions, e.g. ‘raw()’, ‘list()’, and ‘options()’.</p></li>
<li>future(alist(a=)) would produce “Error in objectSize_list(x, depth = depth</li>
<li><p>1L) : argument “x_kk” is missing, with no default"</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-3" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-3" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Future and FutureResult objects with an internal version 1.7 or older have been deprecated since 1.14.0 (July 2019) and are now defunct.</p></li>
<li><p>Defunct hidden argument ‘progress’ of resolve(), and hidden arguments/fields ‘condition’ and ‘calls’ of FutureResult are now gone.</p></li>
</ul>
</div>
</div>
    <div id="future-1-15-1" class="section level1">
<h1 class="page-header" data-toc-text="1.15.1">
<a href="#future-1-15-1" class="anchor"></a>future 1.15.1<small> 2019-11-25 </small>
</h1>
<div id="new-features-7" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-7" class="anchor"></a>New Features</h3>
<ul>
<li>The default range of ports that makeClusterPSOCK() draws a random port from (when argument ‘port’ is not specified) can now be controlled by environment variable `R_FUTURE_RANDOM_PORTS`. The default range is still 11000:11999 as with the ‘parallel’ package.</li>
</ul>
</div>
<div id="bug-fixes-9" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-9" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>The change introduced to resolved() in future 1.15.0 would cause lazy futures to block if all workers were occupied.</li>
</ul>
</div>
</div>
    <div id="future-1-15-0" class="section level1">
<h1 class="page-header" data-toc-text="1.15.0">
<a href="#future-1-15-0" class="anchor"></a>future 1.15.0<small> 2019-11-08 </small>
</h1>
<div id="significant-changes-6" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-6" class="anchor"></a>Significant Changes</h3>
<ul>
<li>resolved() will now launch lazy futures.</li>
</ul>
</div>
<div id="new-features-8" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-8" class="anchor"></a>New Features</h3>
<ul>
<li><p>Now the “visibility” of future values is recorded and reflected by value().</p></li>
<li><p>Now option ‘future.globals.onReference’ defaults to environment variable ‘R_FUTURE_GLOBALS_ONREFERENCE’.</p></li>
</ul>
</div>
<div id="documentation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-1" class="anchor"></a>Documentation</h3>
<ul>
<li>Added ‘Troubleshooting’ section to ?makeClusterPSOCK with instructions on how to troubleshoot when the setup of local and remote clusters fail.</li>
</ul>
</div>
<div id="bug-fixes-10" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-10" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>values() would resignal immediateCondition:s despite those should only be signaled at most once per future.</p></li>
<li><p>makeClusterPSOCK() could produce warnings like “cannot open file ‘/tmp/alice/Rtmpi69yYF/future.parent=2622.a3e32bc6af7.pid’: No such file”, e.g. when launching R workers running in Docker containers.</p></li>
<li><p>Package would set or update the RNG state of R (.Random.seed) when loaded, which could affect RNG reproducibility.</p></li>
<li><p>Package could set ‘.Random.seed’ to NULL, instead of removing it, which in turn would produce a warning on “‘.Random.seed’ is not an integer vector but of type ‘NULL’, so ignored” when the next random number generated.</p></li>
<li><p>Now a future assignment to list environments produce more informative error messages if attempting to assign to more than one element.</p></li>
<li><p>makeClusterMPI() did not work for MPI clusters with ‘comm’ other than ‘1’.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-4" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-4" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Argument ‘value’ of resolve() is deprecated. Use ‘result’ instead.</p></li>
<li><p>Use of internal argument ‘evaluator’ is now defunct.</p></li>
</ul>
</div>
</div>
    <div id="future-1-14-0" class="section level1">
<h1 class="page-header" data-toc-text="1.14.0">
<a href="#future-1-14-0" class="anchor"></a>future 1.14.0<small> 2019-07-02 </small>
</h1>
<div id="significant-changes-7" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-7" class="anchor"></a>Significant Changes</h3>
<ul>
<li><p>All types of conditions are now captured and relayed. Previously, only conditions of class ‘message’ and ‘warning’ were relayed.</p></li>
<li><p>If one of the futures in a collection produces an error, then values() will signal that error as soon as it is detected. This means that while calling values() guarantees to resolve all futures, it does not guarantee that the result from all futures are gathered back to the master R session before the error is relayed.</p></li>
</ul>
</div>
<div id="new-features-9" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-9" class="anchor"></a>New Features</h3>
<ul>
<li><p>values() now relays ‘stdout’ and ‘signal’ as soon as possible as long as the standard output and the conditions are relayed in their original order.</p></li>
<li><p>If a captured condition can be “muffled”, then it will be muffled. This helps to prevent conditions from being handled twice by condition handlers when futures are evaluated in the main R session, e.g. plan(sequential). Messages and warnings were already muffled in the past.</p></li>
<li><p>Forked processing is considered unstable when running R from certain environments, such as the RStudio environment. Because of this, ‘multicore’ futures have been disabled in those cases since future 1.13.0. This change caught several RStudio users by surprise. Starting with future 1.14.0, an informative one-time-per-session warning will be produced when attempts to use ‘multicore’ is made in non-supported environments such as RStudio. This warning will also be produced when using ‘multiprocess’, which will fall back to using ‘multisession’ futures. The warning can be disabled by setting R option ‘future.supportsMulticore.unstable’, or environment variable ‘FUTURE_SUPPORTSMULTICORE_UNSTABLE’ to “quiet”.</p></li>
<li><p>Now option ‘future.startup.script’ falls back to environment variable ‘R_FUTURE_STARTUP_SCRIPT’.</p></li>
<li><p>Conditions inheriting ‘immediateCondition’ are signaled as soon as possible. Contrary to other types of conditions, these will be signaled only once per future, despite being collected.</p></li>
</ul>
</div>
<div id="bug-fixes-11" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-11" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Early signaling did not take place for resolved() for ClusterFuture and MulticoreFuture.</p></li>
<li><p>When early signaling was enabled, functions such as resolved() and resolve() would relay captured conditions multiple times. This would, for instance, result in the same messages and warnings being outputted more than once. Now it is only value() that will resignal conditions.</p></li>
<li><p>The validation of connections failed to detect when the connection had been serialized (= a NIL external pointer) on some macOS systems.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-5" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-5" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Argument ‘progress’ of resolve() is now defunct (was deprecated since future 1.12.0). Option ‘future.progress’ is ignored. This will make room for other progress-update mechanisms that are in the works.</p></li>
<li><p>Usage of internal argument ‘evaluator’ is now deprecated.</p></li>
<li><p>Removed defunct argument ‘output’ from FutureError().</p></li>
<li><p>FutureResult fields/arguments ‘condition’ and ‘calls’ are now defunct. Use ‘conditions’ instead.</p></li>
<li><p>Future and FutureResult objects with an internal version 1.7 or older are deprecated and will eventually become defunct. Future backends that implement their own Future classes should update to implement a result() method instead of a value() method for their Future classes. All future backends available on CRAN and Bioconductor have already been updated accordingly.</p></li>
</ul>
</div>
</div>
    <div id="future-1-13-0" class="section level1">
<h1 class="page-header" data-toc-text="1.13.0">
<a href="#future-1-13-0" class="anchor"></a>future 1.13.0<small> 2019-05-08 </small>
</h1>
<div id="significant-changes-8" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-8" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Forked processing is now disabled by default when running R via RStudio When disabled, ‘multicore’ futures fall back to a ‘sequential’ futures. This update follows from an RStudio recommendation against using _forked_ parallel processing from within RStudio because it is likely to break the RStudio R session. See help(“supportsMulticore”) for more details, e.g. how to re-enable process forking. Note that parallelization via ‘multisession’ is unaffected and will still work as before. Also, when forked processing is disabled, or otherwise not supported, using plan(“multiprocess”) will fall back to using ‘multisession’ futures.</li>
</ul>
</div>
<div id="new-features-10" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-10" class="anchor"></a>New Features</h3>
<ul>
<li><p>Forked processing can be disabled by setting R option ‘future.fork.enable’ to FALSE (or environment variable ‘R_FUTURE_FORK_ENABLE=false’). When disabled, ‘multicore’ futures fall back to a ‘sequential’ futures even if the operating system supports process forking. If set of TRUE, ‘multicore’ will not fall back to ‘sequential’. If NA, or not set (the default), a set of best-practices rules will decide whether forking is enabled or not. See help(“supportsMulticore”) for more details.</p></li>
<li><p>Now availableCores() also recognizes PBS environment variable ‘NCPUS’, because the PBSPro scheduler does not set ‘PBS_NUM_PPN’.</p></li>
<li><p>If, option ‘future.availableCores.custom’ is set to a function, then availableCores() will call that function and interpret its value as number of cores. Analogously, option ‘future.availableWorkers.custom’ can be used to specify a hostnames of a set of workers that availableWorkers() sees. These new options provide a mechanism for anyone to customize availableCores() and availableWorkers() in case they do not (yet) recognize, say, environment variables that are specific the user’s compute environment or HPC scheduler.</p></li>
<li><p>makeClusterPSOCK() gained support for argument ‘rscript_startup’ for evaluating one or more R expressions in the background R worker prior to the worker event loop launching. This provides a more convenient approach than having to use, say, ‘rscript_args = c(“-e”, sQuote(code))’.</p></li>
<li><p>makeClusterPSOCK() gained support for argument ‘rscript_libs’ to control the R package library search path on the workers. For example, to _prepend_ the folder ‘~/R-libs’ on the workers, use ‘rscript_libs = c(“~/R-libs”, “*”)’, where “*” will be resolved to the current ‘.libPaths()’ on the workers.</p></li>
<li><p>Debug messages are now prepended with a timestamp.</p></li>
</ul>
</div>
<div id="documentation-2" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-2" class="anchor"></a>Documentation</h3>
<ul>
<li>Add vignette on ‘Non-Exportable Objects’ (extracted from another vignette).</li>
</ul>
</div>
<div id="bug-fixes-12" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-12" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>makeClusterPSOCK() did not shell quote the Rscript executable when running its pre-tests checking whether localhost Rscript processes can be killed by their PIDs or not.</li>
</ul>
</div>
<div id="deprecated-and-defunct-6" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-6" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>Argument ‘value’ of resolve() has been renamed to `result` to better reflect that not only values are collected when this argument is used. Argument ‘value’ still works for backward compatibility, but will eventually be formally deprecated and then defunct.</li>
</ul>
</div>
</div>
    <div id="future-1-12-0" class="section level1">
<h1 class="page-header" data-toc-text="1.12.0">
<a href="#future-1-12-0" class="anchor"></a>future 1.12.0<small> 2019-03-08 </small>
</h1>
<div id="new-features-11" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-11" class="anchor"></a>New Features</h3>
<ul>
<li><p>If makeClusterPSOCK() fails to create one of many nodes, then it will attempt to stop any nodes that were successfully created. This lowers the risk for leaving R worker processes behind.</p></li>
<li><p>Future results now hold the timestamps when the evaluation of the future started and finished.</p></li>
</ul>
</div>
<div id="bug-fixes-13" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-13" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Functions no longer produce “partial match of ‘condition’ to ‘conditions’” warnings with options(warnPartialMatchDollar=TRUE).</p></li>
<li><p>When future infix operators (%conditions%, %globals%, %label%, %lazy%, %packages%, %seed%, and %stdout%) that are intended for future assignments were used in the wrong context, they would incorrectly be applied to the next future created. Now they’re discarded.</p></li>
<li><p>makeClusterPSOCK() in future (&gt;= 1.11.1) produced warnings when argument ‘rscript’ had length(rscript) &gt; 1.</p></li>
<li><p>Validation of L’Ecuyer-CMRG RNG seeds failed in recent R devel.</p></li>
<li><p>With options(OutDec = “,”), the default value of several argument would resolve to NA_real_ rather than a numeric value resulting in errors such as “is.finite(alpha) is not TRUE”.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-7" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-7" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Argument ‘progress’ of resolve() is now deprecated.</p></li>
<li><p>Argument ‘output’ of FutureError() is now defunct.</p></li>
<li><p>FutureError no longer inherits simpleError.</p></li>
</ul>
</div>
</div>
    <div id="future-1-11-1-1" class="section level1">
<h1 class="page-header" data-toc-text="1.11.1.1">
<a href="#future-1-11-1-1" class="anchor"></a>future 1.11.1.1<small> 2019-01-26 </small>
</h1>
<div id="bug-fixes-14" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-14" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>When makeClusterPSOCK() fails to connect to a worker, it produces an error with detailed information on what could have happened. In rare cases, another error could be produced when generating the information on what the workers PID is.</li>
</ul>
</div>
</div>
    <div id="future-1-11-1" class="section level1">
<h1 class="page-header" data-toc-text="1.11.1">
<a href="#future-1-11-1" class="anchor"></a>future 1.11.1<small> Unreleased </small>
</h1>
<div id="new-features-12" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-12" class="anchor"></a>New Features</h3>
<ul>
<li><p>The defaults of several arguments of makeClusterPSOCK() and makeNodePSOCK() can now be controlled via environment variables in addition to R options that was supported in the past. An advantage of using environment variables is that they will be inherited by child processes, also nested ones.</p></li>
<li><p>The printing of future plans is now less verbose when the ‘workers’ argument is a complex object such as a PSOCK cluster object. Previously, the output would include verbose output of attributes etc.</p></li>
</ul>
</div>
<div id="software-quality" class="section level3">
<h3 class="hasAnchor">
<a href="#software-quality" class="anchor"></a>Software Quality</h3>
<ul>
<li>TESTS: When the ‘future’ package is loaded, it checks whether ‘R CMD check’ is running or not. If it is, then a few future-specific environment variables are adjusted such that the tests play nice with the testing environment. For instance, it sets the socket connection timeout for PSOCK cluster workers to 120 seconds (instead of the default 30 days!). This will lower the risk for more and more zombie worker processes cluttering up the test machine (e.g. CRAN servers) in case a worker process is left behind despite the main R processes is terminated. Note that these adjustments are applied automatically to the checks of any package that depends on, or imports, the ‘future’ package.</li>
</ul>
</div>
<div id="bug-fixes-15" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-15" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>Whenever makeClusterPSOCK() would fail to connect to a worker, for instance due to a port clash, then it would leave the R worker process running - also after the main R process terminated. When the worker is running on the same machine, makeClusterPSOCK() will now attempt to kill such stray R processes. Note that parallel::makePSOCKcluster() still has this problem.</li>
</ul>
</div>
</div>
    <div id="future-1-11-0" class="section level1">
<h1 class="page-header" data-toc-text="1.11.0">
<a href="#future-1-11-0" class="anchor"></a>future 1.11.0<small> 2019-01-21 </small>
</h1>
<div id="significant-changes-9" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-9" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Message and warning conditions are now captured and relayed by default.</li>
</ul>
</div>
<div id="new-features-13" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-13" class="anchor"></a>New Features</h3>
<ul>
<li><p>The future call stack (“traceback”) is now recorded when the evaluation of a future produces an error. Use backtrace() on the future to retrieve it.</p></li>
<li><p>Now futureCall() defaults to args = list() making is easier to call functions that do not take arguments, e.g. futureCall(function() 42).</p></li>
<li><p>plan() gained argument ‘.skip = FALSE’. When TRUE, setting the same future strategy as already set will be skipped, e.g. calling plan(multisession) consecutively will have the same effect as calling it just once.</p></li>
<li><p>makeClusterPSOCK() produces more informative error messages whenever the setup of R workers fails. Also, its verbose messages are now prefixed with “[local output]” to help distinguish the output produced by the current R session from that produced by background workers.</p></li>
<li><p>It is now possible to specify what type of SSH clients makeClusterPSOCK() automatically searches for and in what order, e.g. ‘rshcmd = c(“<rstudio-ssh>”, “<putty-plink>”)’.</putty-plink></rstudio-ssh></p></li>
<li><p>Now makeClusterPSOCK() preserves the global RNG state (.Random.seed) also when it draws a random port number.</p></li>
<li><p>makeClusterPSOCK() gained argument ‘rshlogfile’.</p></li>
<li><p>Cluster futures provide more informative error messages when the communication with the worker node is out of sync.</p></li>
</ul>
</div>
<div id="bug-fixes-16" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-16" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Argument ‘stdout’ was forced to TRUE when using single-core multicore or single-core multisession futures.</p></li>
<li><p>When evaluated in a local environment, futureCall(…, globals = “a”) would set the value of global ‘a’ to NULL, regardless if it exists or not and what its true value is.</p></li>
<li><p>makeClusterPSOCK(…, rscript = “my_r”) would in some cases fail to find the intended ‘my_r’ executable.</p></li>
<li><p>ROBUSTNESS: A cluster future, including a multisession one, could retrieve results from the wrong workers if a new set of cluster workers had been set up after the future was created/launched but before the results were retrieved. This could happen because connections in R are indexed solely by integers which are recycled when old connections are closed and new ones are created. Now cluster futures assert that the connections to the workers are valid, and if not, an informative error message is produced.</p></li>
<li><p>Calling result() on a non-resolved UniprocessFuture would signal evaluation errors.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-8" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-8" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>Removed defunct future::future_lapply(). Please use the one in the future.apply package instead.</li>
</ul>
</div>
</div>
    <div id="future-1-10-0" class="section level1">
<h1 class="page-header" data-toc-text="1.10.0">
<a href="#future-1-10-0" class="anchor"></a>future 1.10.0<small> 2018-10-17 </small>
</h1>
<div id="new-features-14" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-14" class="anchor"></a>New Features</h3>
<ul>
<li><p>Add support for manually specifying globals in addition to those that are automatically identified via argument ‘globals’ or %globals%. Two examples are globals = structure(TRUE, add = list(a = 42L, b = 3.14)) and globals = structure(TRUE, add = c(“a”, “b”)). Analogously, attribute ‘ignore’ can be used to exclude automatically identified globals.</p></li>
<li><p>The error reported when failing to retrieve the results of a future evaluated on a localhost cluster/multisession worker or a forked/multicore worker is now more informative. Specifically, it mentions whether the worker process is still alive or not.</p></li>
<li><p>Add makeClusterMPI(n) for creating MPI-based clusters of a similar kind as parallel::makeCluster(n, type = “MPI”) but that also attempts to workaround issues where parallel::stopCluster() causes R to stall.</p></li>
<li><p>makeClusterPSOCK() and makeClusterMPI() gained argument ‘autoStop’ for controlling whether the cluster should be automatically stopped when garbage collected or not.</p></li>
<li><p>BETA: Now resolved() for ClusterFuture is non-blocking also for clusters of type MPIcluster as created by parallel::makeCluster(…, type = “MPI”).</p></li>
</ul>
</div>
<div id="bug-fixes-17" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-17" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>On Windows, plan(multiprocess) would not initiate the workers. Instead workers would be set up only when the first future was created.</li>
</ul>
</div>
</div>
    <div id="future-1-9-0" class="section level1">
<h1 class="page-header" data-toc-text="1.9.0">
<a href="#future-1-9-0" class="anchor"></a>future 1.9.0<small> 2018-07-23 </small>
</h1>
<div id="significant-changes-10" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-10" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Standard output is now captured and re-outputted when value() is called. This new behavior can be controlled by the argument ‘stdout’ to future() or by specifying the %stdout% operator if a future assignment is used.</li>
</ul>
</div>
<div id="new-features-15" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-15" class="anchor"></a>New Features</h3>
<ul>
<li><p>R option ‘width’ is passed down so that standard output is captured consistently across workers and consistently with the master process.</p></li>
<li><p>Now more ‘future.*’ options are passed down so that they are also acknowledged when using nested futures.</p></li>
</ul>
</div>
<div id="documentation-3" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-3" class="anchor"></a>Documentation</h3>
<ul>
<li><p>Add vignette on ‘Outputting Text’.</p></li>
<li><p>CLEANUP: Only the core parts of the API are now listed in the help index. This was done to clarify the Future API. Help for non-core parts are still via cross references in the indexed API as well via help().</p></li>
</ul>
</div>
<div id="bug-fixes-18" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-18" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>When using forced, nested ‘multicore’ parallel processing, such as, plan(list(tweak(multicore, workers = 2), tweak(multicore, workers = 2))), then the child process would attempt to resolve futures owned by the parent process resulting in an error (on ‘bad error message’).</p></li>
<li><p>When using plan(multicore), if a forked worker would terminate unexpectedly, it could corrupt the master R session such that any further attempts of using forked workers would fail. A forked worker could be terminated this way if the user pressed Ctrl-C (the worker receives a SIGINT signal).</p></li>
<li><p>makeClusterPSOCK() produced a warning when environment variable ‘R_PARALLEL_PORT’ was set to ‘random’ (e.g. as on CRAN).</p></li>
<li><p>Printing a plan() could produce an error when the deparsed call used to set up the plan() was longer than 60 characters.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-9" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-9" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>future::future_lapply() is defunct (gives an error if called). Please use the one in the future.apply package instead.</p></li>
<li><p>Argument ‘output’ of FutureError() is formally deprecated.</p></li>
<li><p>Removed all FutureEvaluationCondition classes and related methods.</p></li>
</ul>
</div>
</div>
    <div id="future-1-8-1" class="section level1">
<h1 class="page-header" data-toc-text="1.8.1">
<a href="#future-1-8-1" class="anchor"></a>future 1.8.1<small> 2018-05-03 </small>
</h1>
<div id="new-features-16" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-16" class="anchor"></a>New Features</h3>
<ul>
<li><p>getGlobalsAndPackages() gained argument ‘maxSize’.</p></li>
<li><p>makeClusterPSOCK() now produces a more informative warning if environment variable R_PARALLEL_PORT specifies a non-numeric port.</p></li>
<li><p>Now plan() gives a more informative error message in case it fails, e.g. when the internal future validation fails and why.</p></li>
<li><p>Added UnexpectedFutureResultError to be used by backends for signaling in a standard way that an unexpected result was retrieved from a worker.</p></li>
</ul>
</div>
<div id="bug-fixes-19" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-19" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>When the communication between an asynchronous future and a background R process failed, further querying of the future state/results could end up in an infinite waiting loop. Now the failed communication error is recorded and re-signaled if any further querying attempts.</p></li>
<li><p>Internal, seldom used myExternalIP() failed to recognize IPv4 answers from some of the lookup servers. This could in turn produce another error.</p></li>
<li><p>In R (&gt;= 3.5.0), multicore futures would produce multiple warnings originating from querying whether background processes have completed or not. These warnings are now suppressed.</p></li>
</ul>
</div>
</div>
    <div id="future-1-8-0" class="section level1">
<h1 class="page-header" data-toc-text="1.8.0">
<a href="#future-1-8-0" class="anchor"></a>future 1.8.0<small> 2018-04-08 </small>
</h1>
<div id="significant-changes-11" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-11" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Errors produces when evaluating futures are now (re-)signaled on the master R process “as is” with the original content and class attributes.</li>
</ul>
</div>
<div id="new-features-17" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-17" class="anchor"></a>New Features</h3>
<ul>
<li><p>More errors related to orchestration of futures are of class FutureError to make it easier to distinguish them from future evaluation errors.</p></li>
<li><p>Add support for a richer set of results returned by resolved futures. Previously only the value of the future expression, which could be a captured error to be resignaled, was expected. Now a FutureResult object may be returned instead. Although not supported in this release, this update opens up for reporting on additional information from the evaluation of futures, e.g. captured output, timing and memory benchmarks etc. Before that can take place, existing future backend packages will have to be updated accordingly.</p></li>
<li><p>backtrace() returns only the last call that produced the error. It is unfortunately not possible to capture the call stack that led up to the error when evaluating a future expression.</p></li>
</ul>
</div>
<div id="bug-fixes-20" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-20" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>value() for MulticoreFuture would not produce an error when a (forked) background R workers would terminate before the future expression is resolved. This was a limitation inherited from the parallel package. Now an informative FutureError message is produced.</p></li>
<li><p>value() for MulticoreFuture would not signal errors unless they inherited from ‘simpleError’ - now it’s enough for them to inherits from ‘error’.</p></li>
<li><p>value() for ClusterFuture no longer produces a FutureEvaluationError, but FutureError, if the connection to the R worker has changed (which happens if something as drastic as closeAllConnections() have been called.)</p></li>
<li><p>futureCall(…, globals = FALSE) would produce “Error: second argument must be a list”, because the explicit arguments where not exported. This could also happen when specifying globals by name or as a named list.</p></li>
<li><p>Nested futures were too conservative in requiring global variables to exist, even when they were false positives.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-10" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-10" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>future::future_lapply() is formally deprecated. Please use the one in the future.apply package instead.</p></li>
<li><p>Recently introduced FutureEvaluationCondition classes are deprecated, because they no longer serve a purpose since future evaluation conditions are now signaled as is.</p></li>
</ul>
</div>
</div>
    <div id="future-1-7-0" class="section level1">
<h1 class="page-header" data-toc-text="1.7.0">
<a href="#future-1-7-0" class="anchor"></a>future 1.7.0<small> 2018-02-11 </small>
</h1>
<div id="significant-changes-12" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-12" class="anchor"></a>Significant Changes</h3>
<ul>
<li>future_lapply() has moved to the future.apply package available on CRAN.</li>
</ul>
</div>
<div id="new-features-18" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-18" class="anchor"></a>New Features</h3>
<ul>
<li><p>Argument ‘workers’ of future strategies may now also be a function, which is called without argument when the future strategy is set up and used as is. For instance, plan(multiprocess, workers = halfCores) where halfCores &lt;- function() { max(1, round(availableCores() / 2)) } will use half of the number of available cores. This is useful when using nested future strategies with remote machines.</p></li>
<li><p>On Windows, makeClusterPSOCK(), and therefore plan(multisession) and plan(multiprocess), will use the SSH client distributed with RStudio as a fallback if neither ‘ssh’ nor ‘plink’ is available on the system PATH.</p></li>
<li><p>Now plan() makes sure that nbrOfWorkers() will work for the new strategy. This will help catch mistakes such as plan(cluster, workers = cl) where ‘cl’ is a basic R list rather than a ‘cluster’ list early on.</p></li>
<li><p>Added %packages% to explicitly control packages to be attached when a future is resolved, e.g. y %&lt;-% { YT[2] } %packages% “data.table”. Note, this is only needed in cases where the automatic identification of global and package dependencies is not sufficient.</p></li>
<li><p>Added condition classes FutureCondition, FutureMessage, FutureWarning, and FutureError representing conditions that occur while a future is setup, launched, queried, or retrieved. They do *not* represent conditions that occur while evaluating the future expression. For those conditions, new classes FutureEvaluationCondition, FutureEvaulationMessage, FutureEvaluationWarning, and FutureEvaluationError exists.</p></li>
</ul>
</div>
<div id="documentation-4" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-4" class="anchor"></a>Documentation</h3>
<ul>
<li>Vignette ‘Common Issues with Solutions’ now documents the case where the future framework fails to identify a variable as being global because it is only so conditionally, e.g. ‘if (runif(1) &lt; 1/2) x &lt;- 0; y &lt;- 2 * x’.</li>
</ul>
</div>
<div id="beta-features-2" class="section level3">
<h3 class="hasAnchor">
<a href="#beta-features-2" class="anchor"></a>Beta Features</h3>
<ul>
<li>Added mechanism for detecting globals that _may_ not be exportable to an external R process (a “worker”). Typically, globals that carry connections and external pointers (“externalptr”) can not be exported, but there are exceptions. By setting options ‘future.globals.onReference’ to “warning”, a warning is produced informing the user about potential problems. If “error”, an error is produced. Because there might be false positive, the default is “ignore”, which will cause above scans to be skipped. If there are non-exportable globals and these tests are skipped, a run-time error may be produced only when the future expression is evaluated.</li>
</ul>
</div>
<div id="bug-fixes-21" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-21" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>The total size of global variables was overestimated, and dramatically so if defined in the global environment and there were are large objects there too. This would sometimes result in a false error saying that the total size is larger than the allowed limit.</p></li>
<li><p>An assignment such as ‘x &lt;- x + 1’ where the left-hand side (LHS) ‘x’ is a global failed to identify ‘x’ as a global because the right-hand side (RHS) ‘x’ would override it as a local variable. Updates to the globals package fixed this problem.</p></li>
<li><p>makeClusterPSOCK(…, renice = 19) would launch each PSOCK worker via ‘nice +19’ resulting in the error “nice: ‘+19’: No such file or directory”. This bug was inherited from parallel::makePSOCKcluster(). Now using ‘nice –adjustment=19’ instead.</p></li>
<li><p>Protection against passing future objects to other futures did not work for future strategy ‘multicore’.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-11" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-11" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>future_lapply() has moved to the new future.apply package available on CRAN. The future::future_lapply() function will soon be deprecated, then defunct, and eventually be removed from the future package. Please update your code to make use of future.apply::future_lapply() instead.</p></li>
<li><p>Dropped defunct ‘eager’ and ‘lazy’ futures; use ‘sequential’ instead.</p></li>
<li><p>Dropped defunct arguments ‘cluster’ and ‘maxCores’; use ‘workers’ instead.</p></li>
<li><p>In previous version of the future package the FutureError class was used to represent both orchestration errors (now FutureError) and evaluation errors (now FutureEvaluationError). Any usage of class FutureError for the latter type of errors is deprecated and should be updated to FutureEvaluationError.</p></li>
</ul>
</div>
</div>
    <div id="future-1-6-2" class="section level1">
<h1 class="page-header" data-toc-text="1.6.2">
<a href="#future-1-6-2" class="anchor"></a>future 1.6.2<small> 2017-10-16 </small>
</h1>
<div id="new-features-19" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-19" class="anchor"></a>New Features</h3>
<ul>
<li><p>Now plan() accepts also strings such as “future::cluster”.</p></li>
<li><p>Now backtrace(x[[ER]]) works also for non-environment ‘x’:s, e.g. lists.</p></li>
</ul>
</div>
<div id="bug-fixes-22" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-22" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>When measuring the size of globals by scanning their content, for certain types of classes the inferred lengths of these objects were incorrect causing internal subset out-of-range issues.</p></li>
<li><p>print() for Future would output one global per line instead of concatenating the information with commas.</p></li>
</ul>
</div>
</div>
    <div id="future-1-6-1" class="section level1">
<h1 class="page-header" data-toc-text="1.6.1">
<a href="#future-1-6-1" class="anchor"></a>future 1.6.1<small> 2017-09-09 </small>
</h1>
<div id="new-features-20" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-20" class="anchor"></a>New Features</h3>
<ul>
<li>Now exporting getGlobalsAndPackages().</li>
</ul>
</div>
<div id="bug-fixes-23" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-23" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>future_lapply() would give “Error in objectSize.env(x, depth = depth - 1L): object ‘nnn’ not found” when for instance ‘nnn’ is part of an unresolved expression that is an argument value.</li>
</ul>
</div>
<div id="software-quality-1" class="section level3">
<h3 class="hasAnchor">
<a href="#software-quality-1" class="anchor"></a>Software Quality</h3>
<ul>
<li>FIX: Some of the package assertion tests made too precise assumptions about the object sizes, which fails with the introduction of ALTREP in R-devel which causes the R’s SEXP header size to change.</li>
</ul>
</div>
</div>
    <div id="future-1-6-0" class="section level1">
<h1 class="page-header" data-toc-text="1.6.0">
<a href="#future-1-6-0" class="anchor"></a>future 1.6.0<small> 2017-08-13 </small>
</h1>
<div id="new-features-21" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-21" class="anchor"></a>New Features</h3>
<ul>
<li>Now tweak(), and hence plan(), generates a more informative error message if a non-future function is specified by mistake, e.g. calling plan(cluster) with the ‘survival’ package attached after ‘future’ is equivalent to calling plan(survival::cluster) when plan(future::cluster) was intended.</li>
</ul>
</div>
<div id="bug-fixes-24" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-24" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>nbrOfWorkers() gave an error with plan(remote). Fixed by making the ‘remote’ future inherit ‘cluster’ (as it should).</li>
</ul>
</div>
<div id="software-quality-2" class="section level3">
<h3 class="hasAnchor">
<a href="#software-quality-2" class="anchor"></a>Software Quality</h3>
<ul>
<li>TESTS: No longer testing forced termination of forked cluster workers when running on Solaris. The termination was done by launching a future that called quit(), but that appeared to have corrupted the main R session when running on Solaris.</li>
</ul>
</div>
<div id="deprecated-and-defunct-12" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-12" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Formally defunct ‘eager’ and ‘lazy’ futures; use ‘sequential’ instead.</p></li>
<li><p>Dropped previously defunct %&lt;=% and %=&gt;% operators.</p></li>
</ul>
</div>
</div>
    <div id="future-1-5-0" class="section level1">
<h1 class="page-header" data-toc-text="1.5.0">
<a href="#future-1-5-0" class="anchor"></a>future 1.5.0<small> 2017-05-26 </small>
</h1>
<div id="significant-changes-13" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-13" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Multicore and multisession futures no longer reserve one core for the main R process, which was done to lower the risk for producing a higher CPU load than the number of cores available for the R session.</li>
</ul>
</div>
<div id="new-features-22" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-22" class="anchor"></a>New Features</h3>
<ul>
<li><p>makeClusterPSOCK() now defaults to use the Windows PuTTY software’s SSH client ‘plink -ssh’, if ‘ssh’ is not found.</p></li>
<li><p>Argument ‘homogeneous’ of makeNodePSOCK(), a helper function of makeClusterPSOCK(), will default to FALSE also if the hostname is a fully qualified domain name (FQDN), that is, it “contains periods”. For instance, c(‘node1’, ‘node2.server.org’) will use homogeneous = TRUE for the first worker and homogeneous = FALSE for the second.</p></li>
<li><p>makeClusterPSOCK() now asserts that each cluster node is functioning by retrieving and recording the node’s session information including the process ID of the corresponding R process.</p></li>
<li><p>Nested futures sets option ‘mc.cores’ to prevent spawning of recursive parallel processes by mistake. Because ‘mc.cores’ controls _additional_ processes, it was previously set to zero. However, since some functions such as mclapply() does not support that, it is now set to one instead.</p></li>
</ul>
</div>
<div id="documentation-5" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-5" class="anchor"></a>Documentation</h3>
<ul>
<li>Help on makeClusterPSOCK() gained more detailed descriptions on arguments and what their defaults are.</li>
</ul>
</div>
<div id="deprecated-and-defunct-13" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-13" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>Formally deprecated eager futures; use sequential instead.</li>
</ul>
</div>
<div id="bug-fixes-25" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-25" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>future_lapply() with multicore / multisession futures, would use a suboptimal workload balancing where it split up the data in one chunk too many. This is no longer a problem because of how argument ‘workers’ is now defined for those type of futures (see note on top).</p></li>
<li><p>future_lapply(), as well as lazy multicore and lazy sequential futures, did not respect option ‘future.globals.resolve’, but was hardcoded to always resolve globals (future.globals.resolve = TRUE).</p></li>
<li><p>When globals larger than the allowed size (option ‘future.globals.maxSize’) are detected an informative error message is generated. Previous version introduced a bug causing the error to produce another error.</p></li>
<li><p>Lazy sequential futures would produce an error when resolved if required packages had been detached.</p></li>
<li><p>print() would not display globals gathered for lazy sequential futures.</p></li>
</ul>
</div>
<div id="software-quality-3" class="section level3">
<h3 class="hasAnchor">
<a href="#software-quality-3" class="anchor"></a>Software Quality</h3>
<ul>
<li><p>Added package tests for globals part of formulas part of other globals, e.g. purrr::map(x, ~ rnorm(.)), which requires globals (&gt;= 0.10.0).</p></li>
<li><p>Now package tests with parallel::makeCluster() not only test for type = ‘PSOCK’ clusters but also ‘FORK’ (when supported).</p></li>
<li><p>TESTS: Cleaned up test scripts such that the overall processing time for the tests was roughly halved, while preserving the same test coverage.</p></li>
</ul>
</div>
</div>
    <div id="future-1-4-0" class="section level1">
<h1 class="page-header" data-toc-text="1.4.0">
<a href="#future-1-4-0" class="anchor"></a>future 1.4.0<small> 2017-03-13 </small>
</h1>
<div id="significant-changes-14" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-14" class="anchor"></a>Significant Changes</h3>
<ul>
<li>The default for future_lapply() is now to _not_ generate RNG seeds (future.seed = FALSE). If proper random number generation is needed, use future.seed = TRUE. For more details, see help page.</li>
</ul>
</div>
<div id="new-features-23" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-23" class="anchor"></a>New Features</h3>
<ul>
<li><p>future() and future_lapply() gained argument ‘packages’ for explicitly specifying packages to be attached when the futures are evaluated. Note that the default throughout the future package is that all globals and all required packages are automatically identified and gathered, so in most cases those do not have to be specified manually.</p></li>
<li><p>The default values for arguments ‘connectTimeout’ and ‘timeout’ of makeNodePSOCK() can now be controlled via global options.</p></li>
</ul>
</div>
<div id="random-number-generation" class="section level3">
<h3 class="hasAnchor">
<a href="#random-number-generation" class="anchor"></a>Random Number Generation</h3>
<ul>
<li><p>Now future_lapply() guarantees that the RNG state of the calling R process after returning is updated compared to what it was before and in the exact same way regardless of ‘future.seed’ (except FALSE), ‘future.scheduling’ and future strategy used. This is done in order to guarantee that an R script calling future_lapply() multiple times should be numerically reproducible given the same initial seed.</p></li>
<li><p>It is now possible to specify a pre-generated sequence of .Random.seed seeds to be used for each FUN(x[i], …) call in future_lapply(x, FUN, …).</p></li>
</ul>
</div>
<div id="performance-2" class="section level3">
<h3 class="hasAnchor">
<a href="#performance-2" class="anchor"></a>Performance</h3>
<ul>
<li>future_lapply() scans global variables for non-resolved futures (to resolve them) and calculate their total size once. Previously, each chunk (a future) would redo this.</li>
</ul>
</div>
<div id="bug-fixes-26" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-26" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Now future_lapply(x, FUN, …) identifies global objects among ‘x’, ‘FUN’ and ‘…’ recursively until no new globals are found. Previously, only the first level of globals were scanned. This is mostly thanks to a bug fix in globals 0.9.0.</p></li>
<li><p>A future that used a global object ‘x’ of a class that overrides length() would produce an error if length(x) reports more elements than what can be subsetted.</p></li>
<li><p>nbrOfWorkers() gave an error with plan(cluster, workers = cl) where ‘cl’ is a cluster object created by parallel::makeCluster() etc. This prevented for instance future_lapply() to work with such setups.</p></li>
<li><p>plan(cluster, workers = cl) where cl &lt;- makeCluster(…, type = MPI“) would give an instant error due to an invalid internal assertion.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-14" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-14" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li><p>Previously deprecated arguments ‘maxCores’ and ‘cluster’ are now defunct.</p></li>
<li><p>Previously deprecated assignment operators %&lt;=% and %=&gt;% are now defunct.</p></li>
<li><p>availableCores(method = “mc.cores”) is now defunct in favor of “mc.cores+1”.</p></li>
</ul>
</div>
</div>
    <div id="future-1-3-0" class="section level1">
<h1 class="page-header" data-toc-text="1.3.0">
<a href="#future-1-3-0" class="anchor"></a>future 1.3.0<small> 2017-02-19 </small>
</h1>
<div id="significant-changes-15" class="section level3">
<h3 class="hasAnchor">
<a href="#significant-changes-15" class="anchor"></a>Significant Changes</h3>
<ul>
<li>Where applicable, workers are now initiated when calling plan(), e.g. plan(cluster) will set up workers on all cluster nodes. Previously, this only happened when the first future was created.</li>
</ul>
</div>
<div id="new-features-24" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-24" class="anchor"></a>New Features</h3>
<ul>
<li><p>Renamed ‘eager’ futures to ‘sequential’, e.g. plan(sequential). The ‘eager’ futures will be deprecated in an upcoming release.</p></li>
<li><p>Added support for controlling whether a future is resolved eagerly or lazily when creating the future, e.g. future(…, lazy = TRUE) futureAssign(…, lazy = TRUE), and x %&lt;-% { … } %lazy% TRUE.</p></li>
<li><p>future(), futureAssign() and futureCall() gained argument ‘seed’, which specifies a L’Ecuyer-CMRG random seed to be used by the future. The seed for future assignment can be specified via %seed%.</p></li>
<li><p>futureAssign() now passes all additional arguments to future().</p></li>
<li><p>Added future_lapply() which supports load balancing (“chunking”) and perfect reproducibility (regardless of type of load balancing and how futures are resolved) via initial random seed.</p></li>
<li><p>Added availableWorkers(). By default it returns localhost workers according to availableCores(). In addition, it detects common HPC allocations given in environment variables set by the HPC scheduler.</p></li>
<li><p>The default for plan(cluster) is now workers = availableWorkers().</p></li>
<li><p>Now plan() stops any clusters that were implicitly created. For instance, a multisession cluster created by plan(multisession) will be stopped when plan(eager) is called.</p></li>
<li><p>makeClusterPSOCK() treats workers that refer to a local machine by its local or canonical hostname as “localhost”. This avoids having to launch such workers over SSH, which may not be supported on all systems / compute cluster.</p></li>
<li><p>Option ‘future.debug’ = TRUE also reports on total size of globals identified and for cluster futures also the size of the individual global variables exported.</p></li>
<li><p>Option ‘future.wait.timeout’ (replaces ‘future.wait.times’) specifies the maximum waiting time for a free workers (e.g. a core or a compute node) before generating a timeout error.</p></li>
<li><p>Option ‘future.availableCores.fallback’, which defaults to environment variable ‘R_FUTURE_AVAILABLECORES_FALLBACK’ can now be used to specify the default number of cores / workers returned by availableCores() and availableWorkers() when no other settings are available. For instance, if R_FUTURE_AVAILABLECORES_FALLBACK=1 is set system wide in an HPC environment, then all R processes that uses availableCores() to detect how many cores can be used will run as single-core processes. Without this fallback setting, and without other core-specifying settings, the default will be to use all cores on the machine, which does not play well on multi-user systems.</p></li>
</ul>
</div>
<div id="globals" class="section level3">
<h3 class="hasAnchor">
<a href="#globals" class="anchor"></a>Globals</h3>
<ul>
<li>Globals part of locally defined functions are now also identified thanks to globals (&gt;= 0.8.0) updates.</li>
</ul>
</div>
<div id="deprecated-and-defunct-15" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-15" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>Lazy futures and plan(lazy) are now deprecated. Instead, use plan(eager) and then f &lt;- future(…, lazy = TRUE) or x %&lt;-% { … } %lazy% TRUE. The reason behind this is that in some cases code that uses futures only works under eager evaluation (lazy = FALSE; the default), or vice verse. By removing the “lazy” future strategy, the user can no longer override the lazy = TRUE / FALSE that the developer is using.</li>
</ul>
</div>
<div id="bug-fixes-27" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-27" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Creation of cluster futures (including multisession ones) would time out already after 40 seconds if all workers were busy. New default timeout is 30 days (option ‘future.wait.timeout’).</p></li>
<li><p>nbrOfWorkers() gave an error for plan(cluster, workers) where ‘workers’ was a character vector or a ‘cluster’ object of the parallel package. Because of this, future_lapply() gave an error with such setups.</p></li>
<li><p>availableCores(methods = “_R_CHECK_LIMIT_CORES_”) would give an error if not running R CMD check.</p></li>
</ul>
</div>
</div>
    <div id="future-1-2-0" class="section level1">
<h1 class="page-header" data-toc-text="1.2.0">
<a href="#future-1-2-0" class="anchor"></a>future 1.2.0<small> 2016-11-12 </small>
</h1>
<div id="new-features-25" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-25" class="anchor"></a>New Features</h3>
<ul>
<li><p>Added makeClusterPSOCK() - a version of parallel::makePSOCKcluster() that allows for more flexible control of how PSOCK cluster workers are set up and how they are launched and communicated with if running on external machines.</p></li>
<li><p>Added generic as.cluster() for coercing objects to cluster objects to be used as in plan(cluster, workers = as.cluster(x)). Also added a c() implementation for cluster objects such that multiple cluster objects can be combined into a single one.</p></li>
<li><p>Added sessionDetails() for gathering details of the current R session.</p></li>
<li><p>plan() and plan(“list”) now prints more user-friendly output.</p></li>
<li><p>On Unix, internal myInternalIP() tries more alternatives for finding the local IP number.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-16" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-16" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>%&lt;=% is deprecated. Use %&lt;-% instead. Same for %=&gt;%.</li>
</ul>
</div>
<div id="bug-fixes-28" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-28" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>values() for lists and list environments of futures where one or more of the futures resolved to NULL would give an error.</p></li>
<li><p>value() for ClusterFuture would give cryptic error message “Error in stop(ex) : bad error message” if the cluster worker had crashed / terminated. Now it will instead give an error message like “Failed to retrieve the value of ClusterFuture from cluster node <a href='https://github.com/HenrikBengtsson/future/issues/1'>#1</a> on ‘localhost’. The reason reported was”error reading from connection“.</p></li>
<li><p>Argument ‘user’ to remote() was ignored (since 1.1.0).</p></li>
</ul>
</div>
</div>
    <div id="future-1-1-1" class="section level1">
<h1 class="page-header" data-toc-text="1.1.1">
<a href="#future-1-1-1" class="anchor"></a>future 1.1.1<small> 2016-10-11 </small>
</h1>
<div id="bug-fixes-29" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-29" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>For the special case where ‘remote’ futures use workers = “localhost” they (again) use the exact same R executable as the main / calling R session (in all other cases it uses whatever ‘Rscript’ is found in the PATH). This was already indeed implemented in 1.0.1, but with the added support for reverse SSH tunnels in 1.1.0 this default behavior was lost.</li>
</ul>
</div>
</div>
    <div id="future-1-1-0" class="section level1">
<h1 class="page-header" data-toc-text="1.1.0">
<a href="#future-1-1-0" class="anchor"></a>future 1.1.0<small> 2016-10-10 </small>
</h1>
<div id="new-features-26" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-26" class="anchor"></a>New Features</h3>
<ul>
<li><p>REMOTE CLUSTERS: It is now very simple to use cluster() and remote() to connect to remote clusters / machines. As long as you can connect via ssh to those machines, it works also with these future. The new code completely avoids incoming firewall and incoming port forwarding issues previously needed. This is done by using reverse SSH tunneling. There is also no need to worry about internal or external IP numbers.</p></li>
<li><p>Added optional argument ‘label’ to all futures, e.g. f &lt;- future(42, label=“answer”) and v %&lt;-% { 42 } %label% “answer”.</p></li>
<li><p>Added argument ‘user’ to cluster() and remote().</p></li>
<li><p>Now all Future classes supports run() for launching the future and value() calls run() if the future has not been launched.</p></li>
<li><p>MEMORY: Now plan(cluster, gc=TRUE) causes the background R session to be garbage collected immediately after the value is collected. Since multisession and remote futures are special cases of cluster futures, the same is true for these as well.</p></li>
<li><p>ROBUSTNESS: Now the default future strategy is explicitly set when no strategies are set, e.g. when used nested futures. Previously, only mc.cores was set so that only a single core was used, but now also plan(“default”) set.</p></li>
<li><p>WORKAROUND: resolved() on cluster futures would block on Linux until future was resolved. This is due to a bug in R. The workaround is to use round the timeout (in seconds) to an integer, which seems to always work / be respected.</p></li>
</ul>
</div>
<div id="globals-1" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-1" class="anchor"></a>Globals</h3>
<ul>
<li><p>Global variables part of subassignments in future expressions are recognized and exported (iff found), e.g. x$a &lt;- value, x[[“a”]] &lt;- value, and x[1,2,3] &lt;- value.</p></li>
<li><p>Global variables part of formulae in future expressions are recognized and exported (iff found), e.g. y ~ x | z.</p></li>
<li><p>As an alternative to the default automatic identification of globals, it is now also possible to explicitly specify them either by their names (as a character vector) or by their names and values (as a named list), e.g. f &lt;- future({ 2*a }, globals=c(“a”)) or f &lt;- future({ 2*a }, globals=list(a=42)). For future assignments one can use the %globals% operator, e.g. y %&lt;-% { 2*a } %globals% c(“a”).</p></li>
</ul>
</div>
<div id="documentation-6" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-6" class="anchor"></a>Documentation</h3>
<ul>
<li>Added vignette on command-line options and other methods for controlling the default type of futures to use.</li>
</ul>
</div>
</div>
    <div id="future-1-0-1" class="section level1">
<h1 class="page-header" data-toc-text="1.0.1">
<a href="#future-1-0-1" class="anchor"></a>future 1.0.1<small> 2016-07-04 </small>
</h1>
<div id="new-features-27" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-27" class="anchor"></a>New Features</h3>
<ul>
<li><p>ROBUSTNESS: For the special case where ‘remote’ futures use workers = “localhost” they now use the exact same R executable as the main / calling R session (in all other cases it uses whatever ‘Rscript’ is found in the PATH).</p></li>
<li><p>FutureError now extends simpleError and no longer the error class of captured errors.</p></li>
</ul>
</div>
<div id="documentation-7" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-7" class="anchor"></a>Documentation</h3>
<ul>
<li>Adding section to vignette on globals in formulas describing how they are currently not automatically detected and how to explicitly export them.</li>
</ul>
</div>
<div id="bug-fixes-30" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-30" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Since future 0.13.0, a global ‘pkg’ would be overwritten by the name of the last package attached in future.</p></li>
<li><p>Futures that generated R.oo::Exception errors, they triggered another internal error.</p></li>
</ul>
</div>
</div>
    <div id="future-1-0-0" class="section level1">
<h1 class="page-header" data-toc-text="1.0.0">
<a href="#future-1-0-0" class="anchor"></a>future 1.0.0<small> 2016-06-24 </small>
</h1>
<div id="new-features-28" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-28" class="anchor"></a>New Features</h3>
<ul>
<li><p>Add support for remote(…, myip=“<external>”), which now queries a set of external lookup services in case one of them fails.</external></p></li>
<li><p>Add mandelbrot() function used in demo to the API for convenience.</p></li>
<li><p>ROBUSTNESS: If .future.R script, which is sourced when the future package is attached, gives an error, then the error is ignored with a warning.</p></li>
<li><p>TROUBLESHOOTING: If the future requires attachment of packages, then each namespace is loaded separately and before attaching the package. This is done in order to see the actual error message in case there is a problem while loading the namespace. With require()/library() this error message is otherwise suppressed and replaced with a generic one.</p></li>
</ul>
</div>
<div id="globals-2" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-2" class="anchor"></a>Globals</h3>
<ul>
<li><p>Falsely identified global variables no longer generate an error when the future is created. Instead, we leave it to R and the evaluation of the individual futures to throw an error if the a global variable is truly missing. This was done in order to automatically handle future expressions that use non-standard evaluation (NSE), e.g. subset(df, x &lt; 3) where ‘x’ is falsely identified as a global variable.</p></li>
<li><p>Dropped support for system environment variable ‘R_FUTURE_GLOBALS_MAXSIZE’.</p></li>
</ul>
</div>
<div id="documentation-8" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-8" class="anchor"></a>Documentation</h3>
<ul>
<li><p>DEMO: Now the Mandelbrot demo tiles a single Mandelbrot region with one future per tile. This better illustrates parallelism.</p></li>
<li><p>Documented R options used by the future package.</p></li>
</ul>
</div>
<div id="bug-fixes-31" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-31" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Custom futures based on a constructor function that is defined outside a package gave an error.</p></li>
<li><p>plan(“default”) assumed that the ‘future.plan’ option was a string; gave an error if it was a function.</p></li>
<li><p>Various future options were not passed on to futures.</p></li>
<li><p>A startup .future.R script is no longer sourced if the future package is attached by a future expression.</p></li>
</ul>
</div>
</div>
    <div id="future-0-15-0" class="section level1">
<h1 class="page-header" data-toc-text="0.15.0">
<a href="#future-0-15-0" class="anchor"></a>future 0.15.0<small> 2016-06-14 </small>
</h1>
<div id="new-features-29" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-29" class="anchor"></a>New Features</h3>
<ul>
<li><p>Added remote futures, which are cluster futures with convenient default arguments for simple remote access to R, e.g. plan(remote, workers=“login.my-server.org”).</p></li>
<li><p>Now .future.R (if found in the current directory or otherwise in the user’s home directory) is sourced when the future package is attach (but not loaded). This helps separating scripts from configuration of futures.</p></li>
<li><p>Added support for plan(cluster, workers=c(“n1”, “n2”, “n2”, “n4”)), where ‘workers’ (also for ClusterFuture()) is a set of host names passed to parallel::makeCluster(workers). It can also be the number of localhost workers.</p></li>
<li>
<p>Added command line option –parallel=</p>
<p>, which is long for -p </p>
<p>.</p>
</li>
<li>
<p>Now command line option -p </p>
<p> also set the default future strategy to multiprocessing (if p &gt;= 2 and eager otherwise), unless another strategy is already specified via option ‘future.plan’ or system environment variable R_FUTURE_PLAN.</p>
</li>
<li><p>Now availableCores() also acknowledges environment variable NSLOTS set by Sun/Oracle Grid Engine (SGE).</p></li>
<li><p>MEMORY: Added argument ‘gc=FALSE’ to all futures. When TRUE, the garbage collector will run at the very end in the process that evaluated the future (just before returning the value). This may help lowering the overall memory footprint when running multiple parallel R processes. The user can enable this by specifying plan(multiprocess, gc=TRUE). The developer can control this using future(expr, gc=TRUE) or v %&lt;-% { expr } %tweak% list(gc=TRUE).</p></li>
</ul>
</div>
<div id="performance-3" class="section level3">
<h3 class="hasAnchor">
<a href="#performance-3" class="anchor"></a>Performance</h3>
<ul>
<li>Significantly decreased the overhead of creating a future, particularly multicore futures.</li>
</ul>
</div>
<div id="bug-fixes-32" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-32" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>Future would give an error with plan(list(“eager”)), whereas it did work with plan(“eager”) and plan(list(eager)).</li>
</ul>
</div>
</div>
    <div id="future-0-14-0" class="section level1">
<h1 class="page-header" data-toc-text="0.14.0">
<a href="#future-0-14-0" class="anchor"></a>future 0.14.0<small> 2016-05-17 </small>
</h1>
<div id="new-features-30" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-30" class="anchor"></a>New Features</h3>
<ul>
<li><p>Added nbrOfWorkers().</p></li>
<li><p>Added informative print() method for the Future class.</p></li>
<li><p>values() passes arguments ‘…’ to value() of each Future.</p></li>
<li><p>Added FutureError class.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct-17" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecated-and-defunct-17" class="anchor"></a>Deprecated and Defunct</h3>
<ul>
<li>Renamed arguments ‘maxCores’ and ‘cluster’ to ‘workers’. If using the old argument names a deprecation warning will be generated, but it will still work until made defunct in a future release.</li>
</ul>
</div>
<div id="bug-fixes-33" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-33" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>resolve() for lists and environments did not work properly when the set of futures was not resolved in order, which could happen with asynchronous futures.</li>
</ul>
</div>
</div>
    <div id="future-0-13-0" class="section level1">
<h1 class="page-header" data-toc-text="0.13.0">
<a href="#future-0-13-0" class="anchor"></a>future 0.13.0<small> 2016-04-14 </small>
</h1>
<div id="new-features-31" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-31" class="anchor"></a>New Features</h3>
<ul>
<li><p>Add support to plan() for specifying different future strategies for the different levels of nested futures.</p></li>
<li><p>Add backtrace() for listing the trace the expressions evaluated (the calls made) before a condition was caught.</p></li>
<li><p>Add transparent futures, which are eager futures with early signaling of conditioned enabled and whose expression is evaluated in the calling environment. This makes the evaluation of such futures as similar as possible to how R evaluates expressions, which in turn simplifies troubleshooting errors etc.</p></li>
<li><p>Add support for early signaling of conditions. The default is (as before) to signal conditions when the value is queried. In addition, they may be signals as soon as possible, e.g. when checking whether a future is resolved or not.</p></li>
<li><p>Signaling of conditions when calling value() is now controlled by argument ‘signal’ (previously ‘onError’).</p></li>
<li><p>Now UniprocessFuture:s captures the call stack for errors occurring while resolving futures.</p></li>
<li><p>ClusterFuture gained argument ‘persistent=FALSE’. With persistent=TRUE, any objects in the cluster R session that was created during the evaluation of a previous future is available for succeeding futures that are evaluated in the same session. Moreover, globals are still identified and exported but “missing” globals will not give an error - instead it is assumed such globals are available in the environment where the future is evaluated.</p></li>
<li><p>OVERHEAD: Utility functions exported by ClusterFuture are now much smaller; previously they would export all of the package environment.</p></li>
</ul>
</div>
<div id="bug-fixes-34" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-34" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>f &lt;- multicore(NA, maxCores=2) would end up in an endless waiting loop for a free core if availableCores() returned one.</p></li>
<li><p>ClusterFuture would ignore local=TRUE.</p></li>
</ul>
</div>
</div>
    <div id="future-0-12-0" class="section level1">
<h1 class="page-header" data-toc-text="0.12.0">
<a href="#future-0-12-0" class="anchor"></a>future 0.12.0<small> 2016-02-24 </small>
</h1>
<div id="new-features-32" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-32" class="anchor"></a>New Features</h3>
<ul>
<li><p>Added multiprocess futures, which are multicore futures if supported, otherwise multisession futures. This makes it possible to use plan(multiprocess) everywhere regardless of operating system.</p></li>
<li><p>Future strategy functions gained class attributes such that it is possible to test what type of future is currently used, e.g. inherits(plan(), “multicore”).</p></li>
<li><p>ROBUSTNESS: It is only the R process that created a future that can resolve it. If a non-resolved future is queried by another R process, then an informative error is generated explaining that this is not possible.</p></li>
<li><p>ROBUSTNESS: Now value() for multicore futures detects if the underlying forked R process was terminated before completing and if so generates an informative error messages.</p></li>
</ul>
</div>
<div id="performance-4" class="section level3">
<h3 class="hasAnchor">
<a href="#performance-4" class="anchor"></a>Performance</h3>
<ul>
<li>Adjusted the parameters for the schema used to wait for next available cluster node such that nodes are polled more frequently.</li>
</ul>
</div>
<div id="globals-3" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-3" class="anchor"></a>Globals</h3>
<ul>
<li><p>resolve() gained argument ‘recursive’.</p></li>
<li><p>Added option ‘future.globals.resolve’ for controlling whether global variables should be resolved for futures or not. If TRUE, then globals are searched recursively for any futures and if found such “global” futures are resolved. If FALSE, global futures are not located, but if they are later trying to be resolved by the parent future, then an informative error message is generated clarifying that only the R process that created the future can resolve it. The default is currently FALSE.</p></li>
</ul>
</div>
<div id="bug-fixes-35" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-35" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>FIX: Exports of objects available in packages already attached by the future were still exported.</p></li>
<li><p>FIX: Now availableCores() returns 3L (=2L+1L) instead of 2L if _R_CHECK_LIMIT_CORES_ is set.</p></li>
</ul>
</div>
</div>
    <div id="future-0-11-0" class="section level1">
<h1 class="page-header" data-toc-text="0.11.0">
<a href="#future-0-11-0" class="anchor"></a>future 0.11.0<small> 2016-01-20 </small>
</h1>
<div id="new-features-33" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-33" class="anchor"></a>New Features</h3>
<ul>
<li><p>Add multisession futures, which analogously to multicore ones, use multiple cores on the local machine with the difference that they are evaluated in separate R session running in the background rather than separate forked R processes. A multisession future is a special type of cluster futures that do not require explicit setup of cluster nodes.</p></li>
<li><p>Add support for cluster futures, which can make use of a cluster of nodes created by parallel::makeCluster().</p></li>
<li><p>Add futureCall(), which is for futures what do.call() is otherwise.</p></li>
<li><p>Standardized how options are named, i.e. ‘future.<option>’. If you used any future options previously, make sure to check they follow the above format.</option></p></li>
</ul>
</div>
<div id="globals-4" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-4" class="anchor"></a>Globals</h3>
<ul>
<li>All futures now validates globals by default (globals=TRUE).</li>
</ul>
</div>
</div>
    <div id="future-0-10-0" class="section level1">
<h1 class="page-header" data-toc-text="0.10.0">
<a href="#future-0-10-0" class="anchor"></a>future 0.10.0<small> 2015-12-31 </small>
</h1>
<div id="new-features-34" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-34" class="anchor"></a>New Features</h3>
<ul>
<li><p>Now %&lt;=% can also assign to multi-dimensional list environments.</p></li>
<li><p>Add futures(), values() and resolved().</p></li>
<li><p>Add resolve() to resolve futures in lists and environments.</p></li>
<li><p>Now availableCores() also acknowledges the number of CPUs allotted by Slurm.</p></li>
<li><p>CLEANUP: Now the internal future variable created by %&lt;=% is removed when the future variable is resolved.</p></li>
</ul>
</div>
<div id="bug-fixes-36" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-36" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>futureOf(envir=x) did not work properly when ‘x’ was a list environment.</li>
</ul>
</div>
</div>
    <div id="future-0-9-0" class="section level1">
<h1 class="page-header" data-toc-text="0.9.0">
<a href="#future-0-9-0" class="anchor"></a>future 0.9.0<small> 2015-12-12 </small>
</h1>
<div id="new-features-35" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-35" class="anchor"></a>New Features</h3>
<ul>
<li><p>ROBUSTNESS: Now values of environment variables are trimmed before being parsed.</p></li>
<li><p>ROBUSTNESS: Add reproducibility test for random number generation using Pierre L’Ecuyer’s RNG stream regardless of how futures are evaluated, e.g. eager, lazy and multicore.</p></li>
</ul>
</div>
<div id="globals-5" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-5" class="anchor"></a>Globals</h3>
<ul>
<li>Now globals (“unknown” variables) are identified using the new findGlobals(…, method=“ordered”) in globals (&gt; 0.5.0) such that a global variable preceding a local variable with the same name is properly identified and exported/frozen.</li>
</ul>
</div>
<div id="documentation-9" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-9" class="anchor"></a>Documentation</h3>
<ul>
<li>Updated vignette on common issues with the case where a global variable is not identified because it is hidden by an element assignment in the future expression.</li>
</ul>
</div>
<div id="bug-fixes-37" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-37" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>Errors occurring in multicore futures could prevent further multicore futures from being created.</li>
</ul>
</div>
</div>
    <div id="future-0-8-2" class="section level1">
<h1 class="page-header" data-toc-text="0.8.2">
<a href="#future-0-8-2" class="anchor"></a>future 0.8.2<small> 2015-10-14 </small>
</h1>
<div id="bug-fixes-38" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-38" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>Globals that were copies of package objects were not exported to the future environments.</p></li>
<li><p>The future package had to be attached or future::future() had to be imported, if %&lt;=% was used internally in another package. Similarly, it also had to be attached if multicore futures where used.</p></li>
</ul>
</div>
</div>
    <div id="future-0-8-1" class="section level1">
<h1 class="page-header" data-toc-text="0.8.1">
<a href="#future-0-8-1" class="anchor"></a>future 0.8.1<small> 2015-10-05 </small>
</h1>
<div id="documentation-10" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-10" class="anchor"></a>Documentation</h3>
<ul>
<li>Added vignette ‘Futures in R: Common issues with solutions’.</li>
</ul>
</div>
<div id="globals-6" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-6" class="anchor"></a>Globals</h3>
<ul>
<li>eager() and multicore() gained argument ‘globals’, where globals=TRUE will validate that all global variables identified can be located already before the future is created. This provides the means for providing the same tests on global variables with eager and multicore futures as with lazy futures.</li>
</ul>
</div>
<div id="bug-fixes-39" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-39" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>lazy(sum(x, …), globals=TRUE) now properly passes `…` from the function from which the future is setup. If not called within a function or called within a function without `…` arguments, an informative error message is thrown.</li>
</ul>
</div>
</div>
    <div id="future-0-8-0" class="section level1">
<h1 class="page-header" data-toc-text="0.8.0">
<a href="#future-0-8-0" class="anchor"></a>future 0.8.0<small> 2015-09-07 </small>
</h1>
<div id="new-features-36" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-36" class="anchor"></a>New Features</h3>
<ul>
<li><p>plan(“default”) resets to the default strategy, which is synchronous eager evaluation unless option ‘future_plan’ or environment variable ‘R_FUTURE_PLAN’ has been set.</p></li>
<li><p>availableCores(“mc.cores”) returns getOption(“mc.cores”) + 1L, because option ‘mc.cores’ specifies “allowed number of _additional_ R processes” to be used in addition to the main R process.</p></li>
</ul>
</div>
<div id="bug-fixes-40" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-40" class="anchor"></a>Bug Fixes</h3>
<ul>
<li>plan(future::lazy) and similar gave errors.</li>
</ul>
</div>
</div>
    <div id="future-0-7-0" class="section level1">
<h1 class="page-header" data-toc-text="0.7.0">
<a href="#future-0-7-0" class="anchor"></a>future 0.7.0<small> 2015-07-14 </small>
</h1>
<div id="new-features-37" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-37" class="anchor"></a>New Features</h3>
<ul>
<li><p>multicore() gained argument ‘maxCores’, which makes it possible to use for instance plan(multicore, maxCores=4L).</p></li>
<li><p>Add availableMulticore() [from (in-house) ‘async’ package].</p></li>
</ul>
</div>
<div id="documentation-11" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-11" class="anchor"></a>Documentation</h3>
<ul>
<li>More colorful demo(“mandelbrot”, package=“future”).</li>
</ul>
</div>
<div id="bug-fixes-41" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-41" class="anchor"></a>Bug Fixes</h3>
<ul>
<li><p>ROBUSTNESS: multicore() blocks until one of the CPU cores is available, iff all are currently occupied by other multicore futures.</p></li>
<li><p>old &lt;- plan(new) now returns the old plan/strategy (was the newly set one).</p></li>
</ul>
</div>
</div>
    <div id="future-0-6-0" class="section level1">
<h1 class="page-header" data-toc-text="0.6.0">
<a href="#future-0-6-0" class="anchor"></a>future 0.6.0<small> 2015-06-19 </small>
</h1>
<div id="new-features-38" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-38" class="anchor"></a>New Features</h3>
<ul>
<li>Add multicore futures, which are futures that are resolved asynchronously in a separate process. These are only supported on Unix-like systems, but not on Windows.</li>
</ul>
</div>
</div>
    <div id="future-0-5-1" class="section level1">
<h1 class="page-header" data-toc-text="0.5.1">
<a href="#future-0-5-1" class="anchor"></a>future 0.5.1<small> Unreleased </small>
</h1>
<div id="new-features-39" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-39" class="anchor"></a>New Features</h3>
<ul>
<li><p>Eager and lazy futures now records the result internally such that the expression is only evaluated once, even if their error values are requested multiple times.</p></li>
<li><p>Eager futures are always created regardless of error or not.</p></li>
<li><p>All Future objects are environments themselves that record the expression, the call environment and optional variables.</p></li>
</ul>
</div>
</div>
    <div id="future-0-5-0" class="section level1">
<h1 class="page-header" data-toc-text="0.5.0">
<a href="#future-0-5-0" class="anchor"></a>future 0.5.0<small> Unreleased </small>
</h1>
<div id="globals-7" class="section level3">
<h3 class="hasAnchor">
<a href="#globals-7" class="anchor"></a>Globals</h3>
<ul>
<li>lazy() “freezes” global variables at the time when the future is created. This way the result of a lazy future is more likely to be the same as an eager future. This is also how globals are likely to be handled by asynchronous futures.</li>
</ul>
</div>
</div>
    <div id="future-0-4-2" class="section level1">
<h1 class="page-header" data-toc-text="0.4.2">
<a href="#future-0-4-2" class="anchor"></a>future 0.4.2<small> Unreleased </small>
</h1>
<div id="new-features-40" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-40" class="anchor"></a>New Features</h3>
<ul>
<li>plan() records the call.</li>
</ul>
</div>
<div id="documentation-12" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation-12" class="anchor"></a>Documentation</h3>
<ul>
<li>Added demo(“mandelbrot”, package=“future”), which can be re-used by other future packages.</li>
</ul>
</div>
</div>
    <div id="future-0-4-1" class="section level1">
<h1 class="page-header" data-toc-text="0.4.1">
<a href="#future-0-4-1" class="anchor"></a>future 0.4.1<small> Unreleased </small>
</h1>
<div id="new-features-41" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-41" class="anchor"></a>New Features</h3>
<ul>
<li><p>Added plan().</p></li>
<li><p>Added eager future - useful for troubleshooting.</p></li>
</ul>
</div>
</div>
    <div id="future-0-4-0" class="section level1">
<h1 class="page-header" data-toc-text="0.4.0">
<a href="#future-0-4-0" class="anchor"></a>future 0.4.0<small> Unreleased </small>
</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Henrik Bengtsson.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9000.</p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


